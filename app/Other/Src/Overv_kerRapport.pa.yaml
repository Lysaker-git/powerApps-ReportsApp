# ************************************************************************************************
# Warning: YAML source code for Canvas Apps is in preview. The schema is being actively developed.
# Content may be incomplete and subject to change.
# This file is read-only and should only be used to review changes made within Power Apps Studio.
# This file isn't used when loading the app. External editing, merging and conflict resolution are
# not supported.
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  OvervåkerRapport:
    Properties:
      Fill: =RGBA(255, 255, 255, 1)
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - Image1:
          Control: Image@2.2.3
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            DisplayMode: =DisplayMode.View
            Height: =1136
            Image: ='Anders+Nord_Post+Norway_Brand+Identity_17'
            ImagePosition: =ImagePosition.Fill
            Transparency: =0.8
            Width: =640
      - HtmlText1_4:
          Control: HtmlViewer@2.1.0
          Properties:
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            Font: =Font.'Open Sans'
            Height: =154
            HtmlText: |-
              ="<div 
                  style='
                      margin:10px;
                      width:560px;
                      height: 70px;
                      background-color:#;
                      box-shadow:0px 0px 20px -2px #ACB2B3;'>
                      </div>"
            Width: =612
            X: =28
            Y: =774
      - OvervåkerAttachment:
          Control: Attachments@2.3.0
          Properties:
            BorderColor: =Color.BlueViolet
            Font: =Font.'Open Sans'
            Height: =126
            HoverFill: =RGBA(186, 202, 226, 1)
            ItemColor: =RGBA(255, 255, 255, 1)
            ItemFill: =RGBA(56, 96, 178, 1)
            ItemHoverFill: =RGBA(186, 202, 226, 1)
            NoAttachmentsText: =""
            PaddingBottom: =5
            PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
            PaddingRight: =5
            PaddingTop: =5
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(0, 18, 107, 1)
            Size: =16
            Tooltip: ="Add Files here"
            Width: =556
            X: =44
            Y: =888
      - HtmlText1_5:
          Control: HtmlViewer@2.1.0
          Properties:
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            Font: =Font.'Open Sans'
            Height: =154
            HtmlText: |-
              ="<div 
                  style='
                      margin:10px;
                      width:560px;
                      height: 70px;
                      background-color:#;
                      box-shadow:0px 0px 20px -2px #ACB2B3;'>
                      </div>"
            Width: =612
            X: =25
            Y: =1020
      - HtmlText1_1:
          Control: HtmlViewer@2.1.0
          Properties:
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            Font: =Font.'Open Sans'
            Height: =154
            HtmlText: |-
              ="<div 
                  style='
                      margin:10px;
                      width:560px;
                      height:70px;
                      background-color:#;
                      box-shadow:0px 0px 20px -2px #ACB2B3;'>
                      </div>"
            Width: =612
            X: =25
            Y: =336
      - HtmlText1_2:
          Control: HtmlViewer@2.1.0
          Properties:
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            Font: =Font.'Open Sans'
            Height: =154
            HtmlText: |-
              ="<div 
                  style='
                      margin:10px;
                      width:560px;
                      height:70px;
                      background-color:#;
                      box-shadow:0px 0px 20px -2px #ACB2B3;'>
                      </div>"
            Width: =612
            X: =25
            Y: =477
      - HtmlText1_3:
          Control: HtmlViewer@2.1.0
          Properties:
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            Font: =Font.'Open Sans'
            Height: =154
            HtmlText: |-
              ="<div 
                  style='
                      margin:10px;
                      width:560px;
                      height:70px;
                      background-color:#;
                      box-shadow:0px 0px 20px -2px #ACB2B3;'>
                      </div>"
            Width: =612
            X: =25
            Y: =620
      - HtmlText1:
          Control: HtmlViewer@2.1.0
          Properties:
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            Font: =Font.'Open Sans'
            Height: =169
            HtmlText: |-
              ="<div 
                  style='
                      margin:10px;
                      width:560px;
                      height:70px;
                      background-color:#;
                      box-shadow:0px 0px 20px -2px #ACB2B3;'>
                      </div>"
            Width: =612
            X: =25
            Y: =180
      - Button1:
          Control: Classic/Button@2.2.0
          Properties:
            BorderColor: =ColorFade(Self.Fill, -15%)
            BorderThickness: =0
            Color: =RGBA(123, 193, 68, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(0, 47, 25, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, 75%)
            Font: =Font.'Open Sans'
            FontWeight: =FontWeight.Bold
            HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(0,100,58,1), -20%)
            OnSelect: |-
              =UpdateContext({vPopUp: true})
            PressedBorderColor: =Self.Fill
            PressedColor: =Self.Fill
            PressedFill: =Self.Color
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =32
            Text: ="SEND MAIL"
            Width: =560
            X: =40
            Y: =1036
      - FlytText:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            BorderThickness: =0
            Clear: =true
            Default: =""
            Font: =Font.'Open Sans'
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            Mode: =TextMode.MultiLine
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            X: =40
            Y: =195
      - OvervåkerHeader:
          Control: Label@2.5.1
          Properties:
            Align: =Align.Center
            BorderColor: =RGBA(0, 18, 107, 1)
            Font: =Font.'Open Sans'
            FontWeight: =FontWeight.Bold
            Height: =62
            Text: ="Overvåker overlevering"
            X: =40
            Y: =35
      - FlytLabel:
          Control: Label@2.5.1
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Font: =Font.'Open Sans'
            FontWeight: =FontWeight.Semibold
            Text: ="Generell Flyt"
            X: =40
            Y: =125
      - UtfordringerLabel:
          Control: Label@2.5.1
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Font: =Font.'Open Sans'
            FontWeight: =FontWeight.Semibold
            Text: ="Utfordringer"
            X: =40
            Y: =279
      - UtfordringerText:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            BorderThickness: =0
            Default: =""
            Font: =Font.'Open Sans'
            Height: |
              =70
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            Mode: =TextMode.MultiLine
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            X: =40
            Y: =349
      - B2Label:
          Control: Label@2.5.1
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Font: =Font.'Open Sans'
            FontWeight: =FontWeight.Semibold
            Text: ="B2"
            X: =40
            Y: =428
      - B2Text:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            BorderThickness: =0
            Default: =""
            Font: =Font.'Open Sans'
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            Mode: =TextMode.MultiLine
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            X: =40
            Y: =490
      - DiverseLabel:
          Control: Label@2.5.1
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Font: =Font.'Open Sans'
            FontWeight: =FontWeight.Semibold
            Text: ="Diverse"
            X: =40
            Y: =722
      - DiverseText:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            BorderThickness: =0
            Default: =""
            Font: =Font.'Open Sans'
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            Mode: =TextMode.MultiLine
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            X: =40
            Y: =787
      - B3Label:
          Control: Label@2.5.1
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Font: =Font.'Open Sans'
            FontWeight: =FontWeight.Semibold
            Text: ="B3"
            X: =40
            Y: =572
      - B3Text:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            BorderThickness: =0
            Default: =""
            Font: =Font.'Open Sans'
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            Mode: =TextMode.MultiLine
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            X: =40
            Y: =635
      - Label2:
          Control: Label@2.5.1
          Properties:
            Align: =Align.Right
            BorderColor: =RGBA(0, 18, 107, 1)
            Font: =Font.'Open Sans'
            Height: =OvervåkerHeader.Height
            Text: =Text(Now(),DateTimeFormat.ShortTime24)
            Visible: =false
            Width: =121
            X: =479
            Y: =35
      - OvervåkerBackBtn:
          Control: Classic/Icon@2.5.0
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            Icon: =Icon.BackArrow
            OnSelect: =Back(ScreenTransition.UnCoverRight)
            X: =536
            Y: =33
      - OvervåkerBackdropAndHTML:
          Control: HtmlViewer@2.1.0
          Group: Group1
          Properties:
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            Font: =Font.'Open Sans'
            Height: =1136
            HtmlText: |-
              ="<div style='
                  background-color:rgba(255,255,255,0.8);
                  height: 1125px;
                  display: grid;
                  place-content: center;
              '>
              <p style='margin: auto auto 0 auto'>Sende e-post?</p>
              <p style='margin: 0 auto 0 auto'>Send mail?</p>
              </div>"
            Visible: =vPopUp
            Width: =637
      - OvervåkerSendMailBtn:
          Control: Classic/Button@2.2.0
          Group: Group1
          Properties:
            BorderColor: =ColorFade(Self.Fill, -15%)
            BorderThickness: =0
            Color: =RGBA(123, 193, 68, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(0, 47, 25, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, 75%)
            Font: =Font.'Open Sans'
            FontWeight: =FontWeight.Bold
            HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(0,100,58,1), -20%)
            OnSelect: |-
              =ClearCollect(
                  OvervakerCollection,
                  {
                      FlytHeader: "Genrell Flyt",
                      FlytContent: FlytText.Text,
                      UtfordringsHeader: "Utfordringer",
                      UtfordringsContent: UtfordringerText.Text,
                      DiverseHeader: "Diverse - OV",
                      DiverseContent: DiverseText.Text,
                      B2Header: "B2",
                      B2Content: B2Text.Text,
                      B3Header: "B3",
                      B3Content: B3Text.Text
                  }
              );
              /*ForAll(
                  OvervakerCollection,
                  Patch(
                      Table1,
                      Defaults(Table1),
                      {
                          'Generell Flyt': ThisRecord.FlytContent,
                          Utfordringer: ThisRecord.UtfordringsContent,
                          'Diverse - OV': ThisRecord.DiverseContent,
                          B2: ThisRecord.B2Content,
                          B3: ThisRecord.B3Content,
                          Name: "",
                          Group: "",
                          Topic: OvervåkerHeader.Text,
                          Shift: ""
                      }
                  )
              );*/
              ClearCollect(
                  FinalValuesSupervisor,
                  {
                      Title: Blank(),
                      Content: Blank()
                  }
              );
              Clear(FinalValuesSupervisor);
              //Collects All Input Boxes - Skips Empty
              ForAll(
                  OvervakerCollection,
                  If(
                      Not(FlytContent = ""),
                      Collect(
                          FinalValuesSupervisor,
                          {
                              Title: FlytHeader,
                              Content: FlytContent
                          }
                      )
                  );
                  If(
                      Not(UtfordringsContent = ""),
                      Collect(
                          FinalValuesSupervisor,
                          {
                              Title: UtfordringsHeader,
                              Content: UtfordringsContent
                          }
                      )
                  );
                  If(
                      Not(DiverseContent = ""),
                      Collect(
                          FinalValuesSupervisor,
                          {
                              Title: DiverseHeader,
                              Content: DiverseContent
                          }
                      )
                  );
                  If(
                      Not(B2Content = ""),
                      Collect(
                          FinalValuesSupervisor,
                          {
                              Title: B2Header,
                              Content: B2Content
                          }
                      )
                  );
                  If(
                      Not(B3Content = ""),
                      Collect(
                          FinalValuesSupervisor,
                          {
                              Title: B3Header,
                              Content: B3Content
                          }
                      )
                  )
              );
              Set(
                  supervisorHeader,
                  $"<tr style='{headerCss}{darkBg}'>
                          <td>
                              <h1 style='{textLight}font-weight: bolder;'>Overvåker{Shift}</h1>
                          </td>
                      </tr>"
              );
              If(
                  Not(IsEmpty(FinalValuesSupervisor)),
                  Set(
                      supervisorMailBody,
                      Concatenate(
                          genericTitles,
                          Concat(
                              FinalValuesSupervisor,
                              Concatenate(
                                  $"<tbody style='{contentBg}'>
                                          <tr>
                                              <td style='{tdCss}'>
                                                  <h4 style='{textCSS}'>{Title}</h4>
                                              </td>
                                              <td style='{tdCss}'>
                                                  <p style='{textCSS}'>{Content}</p>
                                              </td>
                                          </tr>
                                          <tr>
                                              <td style='{tdCss}{w25}{whiteBg}{height5}'></td>
                                              <td style='{tdCss}{w75}{whiteBg}{height5}'></td>
                                          </tr>
                                      </tbody>"
                              )
                          )
                      )
                  )
              );
              Set(
                  FullBodySupervisor,
                  $"{htmlStart}{supervisorHeader}{htmlAfterHeaderBeforeContent}{supervisorMailBody}{htmlAfterContentSomethingStart}{htmlAfterContentSomethingEnd}"
              );
              Set(
                  RecipientsOvervaker,
                  Concat(
                      ClearCollect(
                          EmailCollection,
                          Filter(
                              RecipientsTable,
                              OVRapport = "True"
                          ).Mail
                      ),
                      Mail & ";"
                  )
              );
              Office365Outlook.SendEmailV2(
                  //TestRecipients,
                  RecipientsOvervaker,
                  //Concatenate(
                      //RecipientsLedere,
                      //RecipientsLedereEx
                  //),
                  "Overvåker Overlevering",
                  FullBodySupervisor,
                  {
                      Importance: FontWeight.Normal,
                      IsHtml: true,
                      ReplyTo: "Logistikk.Norge.ROAO.LSO.Oslo.Overvakere@posten.no",
                      Cc: TestRecipients,
                      Attachments: AddColumns(
                          RenameColumns(
                              OvervåkerAttachment.Attachments,
                              Value,
                              ContentBytes
                          ),
                          '@odata.type',
                          ""
                      )
                  }
              );
              Navigate(
                  SucessScreen,
                  ScreenTransition.CoverRight
              )
            PressedBorderColor: =Self.Fill
            PressedColor: =Self.Fill
            PressedFill: =Self.Color
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =32
            Text: ="JA"
            Visible: =vPopUp
            Width: =250
            X: =40
            Y: =711
      - OvervåkerCancelBtn:
          Control: Classic/Button@2.2.0
          Group: Group1
          Properties:
            BorderColor: =ColorFade(Self.Fill, -15%)
            BorderThickness: =0
            Color: =RGBA(123, 193, 68, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(0, 47, 25, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, 75%)
            Font: =Font.'Open Sans'
            FontWeight: =FontWeight.Bold
            HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(0,100,58,1), -20%)
            OnSelect: |-
              =UpdateContext({vPopUp: false})
            PressedBorderColor: =Self.Fill
            PressedColor: =Self.Fill
            PressedFill: =Self.Color
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =32
            Text: ="NEI"
            Visible: =vPopUp
            Width: =250
            X: =350
            Y: =711
