"HospitalRapport As screen.'phoneLayout_FluidGridWithHeaderPageLayout_ver3.0'":
    BackgroundImage: =
    ImagePosition: =ImagePosition.Fill

    Image2_1 As image:
        Height: =1136
        Image: ='Anders+Nord_Post+Norway_Brand+Identity_17'
        ImagePosition: =ImagePosition.Fill
        Transparency: =0.9
        Width: =640
        ZIndex: =1

    Canvas1 As fluidGrid.fluidGridWithBlankCard:
        BorderThickness: =0
        Height: =1136
        Width: =Parent.Width
        ZIndex: =2

        DataCard1 As dataCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            BorderThickness: =0
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =1036
            Width: =Parent.Width
            X: =0
            Y: =0
            ZIndex: =1

            HospitalHeader As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =70
                Size: =21
                Text: ="Hospital Overlevering"
                Width: =560
                X: =40
                Y: =40
                ZIndex: =1

            AvkastLabelHA As label:
                FontWeight: =FontWeight.Semibold
                Height: =70
                Size: =21
                Text: ="Hvordan ser Avkast ut?"
                Width: =560
                X: =40
                Y: =110
                ZIndex: =2

            AvkastInputHA As text:
                Default: =""
                Height: =70
                Mode: =TextMode.MultiLine
                Size: =21
                Width: =560
                X: =40
                Y: =180
                ZIndex: =3

            SkrivingLabelHA As label:
                FontWeight: =FontWeight.Semibold
                Height: =70
                Size: =21
                Text: ="Hvordan går det på Skriving?"
                Width: =560
                X: =40
                Y: =268
                ZIndex: =4

            SkrivingInputHA As text:
                Default: =""
                Height: =70
                Mode: =TextMode.MultiLine
                Size: =21
                Width: =560
                X: =40
                Y: =338
                ZIndex: =5

            ManglendeLabelHANumber As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Semibold
                Height: =70
                Size: =21
                Text: |-
                    ="Manglende:"
                Width: =169
                X: =40
                Y: =408
                ZIndex: =6

            ManglendeInputHANumber As text:
                Align: =Align.Center
                Default: =""
                Format: =TextFormat.Number
                Height: =70
                Size: =21
                Width: =169
                X: =40
                Y: =478
                ZIndex: =7

            SkrivingLabelHANumber As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Semibold
                Height: =70
                Size: =21
                Text: |-
                    ="Skriving:"
                Width: =169
                X: =235
                Y: =408
                ZIndex: =8

            SkrivingInputHANumber As text:
                Align: =Align.Center
                Default: =""
                Format: =TextFormat.Number
                Height: =70
                Size: =21
                Width: =169
                X: =235
                Y: =478
                ZIndex: =9

            UtlLabelHANumber As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Semibold
                Height: =70
                Size: =21
                Text: |-
                    ="Utleverte:"
                Width: =169
                X: =431
                Y: =408
                ZIndex: =10

            UtlInputHANumber As text:
                Align: =Align.Center
                Default: =""
                Format: =TextFormat.Number
                Height: =70
                Size: =21
                Width: =169
                X: =431
                Y: =478
                ZIndex: =11

            CheckLabelHA As label:
                FontWeight: =FontWeight.Semibold
                Height: =70
                Size: =21
                Text: |-
                    ="Kryss av det som er gjort:"
                Width: =560
                X: =39
                Y: =773
                ZIndex: =12

            TommeCheckHA As checkbox:
                FontWeight: =FontWeight.Semibold
                Height: =85
                Size: =21
                Text: ="Hentet Tomme"
                Width: =280
                X: =39
                Y: =843
                ZIndex: =13

            HeisCheckHA As checkbox:
                FontWeight: =FontWeight.Semibold
                Height: =85
                Size: =21
                Text: ="Kjørt Heis"
                Width: =280
                X: =319
                Y: =843
                ZIndex: =14

            BurCheckHA As checkbox:
                FontWeight: =FontWeight.Semibold
                Height: =85
                Size: =21
                Text: ="Byttet Bur"
                Width: =280
                X: =39
                Y: =928
                ZIndex: =15

            BaljeCheckHA As checkbox:
                FontWeight: =FontWeight.Semibold
                Height: =85
                Size: =21
                Text: ="Tømt Balje 146"
                Width: =280
                X: =319
                Y: =928
                ZIndex: =16

            DiverseLabelHA As label:
                FontWeight: =FontWeight.Semibold
                Height: =70
                Size: =21
                Text: |-
                    ="Andre Notater:"
                Width: =560
                X: =40
                Y: =548
                ZIndex: =17

            DiverseInputHA As text:
                Default: =""
                Height: =155
                Mode: =TextMode.MultiLine
                Size: =21
                Width: =560
                X: =40
                Y: =618
                ZIndex: =18

    Icon1_1 As icon.BackArrow:
        Color: =RGBA(0, 0, 0, 1)
        Icon: =Icon.BackArrow
        OnSelect: =Back(ScreenTransition.UnCoverRight)
        X: =536
        Y: =33
        ZIndex: =3

    Button1_3 As button:
        BorderThickness: =0
        Color: =RGBA(123, 193, 68, 1)
        Fill: =RGBA(0, 47, 25, 1)
        FocusedBorderColor: =ColorFade(Self.Fill, 75%)
        FontWeight: =Bold
        Height: =70
        HoverFill: =ColorFade(RGBA(0,100,58,1), -20%)
        OnSelect: |-
            =UpdateContext({vPopUp: true})
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =32
        Text: ="SEND MAIL"
        Width: =560
        X: =43
        Y: =1036
        ZIndex: =4

    Group1_1 As group:
        Height: =5
        Width: =5
        X: =3
        Y: =60
        ZIndex: =8

        HtmlText2_1 As htmlViewer:
            Height: =1136
            HtmlText: |-
                ="<div style='
                    background-color:rgba(255,255,255,0.8);
                    height: 1125px;
                    display: grid;
                    place-content: center;
                '>
                <p style='margin: auto auto 0 auto'>Sende e-post?</p>
                <p style='margin: 0 auto 0 auto'>Send mail?</p>
                </div>"
            Visible: =vPopUp
            Width: =637
            X: =3
            ZIndex: =5

        Button1_5 As button:
            BorderThickness: =0
            Color: =RGBA(123, 193, 68, 1)
            Fill: =RGBA(0, 47, 25, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, 75%)
            FontWeight: =Bold
            Height: =70
            HoverFill: =ColorFade(RGBA(0,100,58,1), -20%)
            OnSelect: |-
                =// This will set the values for Avkast, Skriving and Diverse.
                Set(
                    AvkastText,
                    AvkastInputHA.Text
                );
                Set(
                    SkrivingText,
                    SkrivingInputHA.Text
                );
                Set(
                    DivText,
                    DiverseInputHA.Text
                );
                //This bulk will build the Numbers avkast Cell to make it more readable
                Set(
                    SkrivingInput,
                    Concatenate(
                        SkrivingLabelHANumber.Text,
                        " ",
                        SkrivingInputHANumber.Text
                    )
                );
                Set(
                    ManglendeInput,
                    Concatenate(
                        ManglendeLabelHANumber.Text,
                        " ",
                        ManglendeInputHANumber.Text
                    )
                );
                Set(
                    UtleverteInput,
                    Concatenate(
                        UtlLabelHANumber.Text,
                        " ",
                        UtlInputHANumber.Text
                    )
                );
                Set(
                    NumInput,
                    Concatenate(
                        SkrivingInput,
                        "<br>",
                        ManglendeInput,
                        "<br>",
                        UtleverteInput
                    )
                );
                //This will build the checklist Cell to make it more readable. 
                Set(
                    TommeCheck,
                    Concatenate(
                        TommeCheckHA.Text,
                        ": ",
                        If(
                            TommeCheckHA.Value,
                            "Ja",
                            "Nei"
                        )
                    )
                );
                Set(
                    HeisCheck,
                    Concatenate(
                        HeisCheckHA.Text,
                        ": ",
                        If(
                            HeisCheckHA.Value,
                            "Ja",
                            "Nei"
                        )
                    )
                );
                Set(
                    BurCheck,
                    Concatenate(
                        BurCheckHA.Text,
                        ": ",
                        If(
                            BurCheckHA.Value,
                            "Ja",
                            "Nei"
                        )
                    )
                );
                Set(
                    BaljeCheck,
                    Concatenate(
                        BaljeCheckHA.Text,
                        ": ",
                        If(
                            BaljeCheckHA.Value,
                            "Ja",
                            "Nei"
                        )
                    )
                );
                Set(
                    CheckInput,
                    Concatenate(
                        TommeCheck,
                        "<br>",
                        HeisCheck,
                        "<br>",
                        BurCheck,
                        "<br>",
                        BaljeCheck
                    )
                );
                // Keeping Formulas out of mail with shift Check
                Set(
                    ShiftCheck,
                    If(
                        Int(
                            Left(
                                Label2,
                                2
                            )
                        ) <= 7,
                        "Early Shift",
                        Int(
                            Left(
                                Label2,
                                2
                            )
                        ) >= 20,
                        "Evening Shift",
                        "Day Shift"
                    )
                );
                // Headers variable
                Set(
                    Header,
                    HospitalHeader.Text
                );
                Set(
                    ThisUser,
                    Office365Users.MyProfile().DisplayName
                );
                Set(
                    Body,
                    Concatenate(
                        "<!DOCTYPE html>",
                        "<html lang='en'>",
                        "<head>",
                        "<meta charset='UTF-8'>",
                        "<meta http-equiv='X-UA-Compatible' content='IE=edge'>",
                        "<meta name='viewport' content='width=device-width, initial-scale=1.0'>",
                        "<title>RAPPORT</title>",
                        "<style>",
                        "   body {background-color: #f1f7e9;} ",
                        "   table {",
                        "       table-layout: fixed;",
                        "       width: 100%;",
                        "       height: 100%;",
                        "       font-family: Verdana, Geneva, Tahoma, sans-serif;",
                        "       border-collapse: collapse;}",
                        "       caption {padding: 10px; font-weight: bolder; font-size: 20px;}",
                        "       thead {height: 50px;}",
                        "       tr {border-bottom: 2px solid rgb(237, 157, 157);}",
                        "       th, td {text-align: start; width: 30%;}",
                        "       th {padding: 10px;}",
                        "</style>",
                        "</head>",
                        "<body>",
                        "   <table>",
                        "       <caption>",
                                    Header,
                        "       </caption>",
                        "       <thead>",
                        "           <tr>",
                        "               <th scope='col'></th>",
                        "               <th style='text-align: start' scope='col'></th>",
                        "               <th style='text-align: start' scope='col'></th>",
                        "           </tr>",
                        "       </thead>",
                        "       <tbody>",
                        "           <tr style='background-color: white;'>",
                        "               <th scope='row'>Avkast:</th>",
                        "               <td colspan='2'>",
                                            AvkastText,
                        "               </td>",
                        "           </tr>",
                        "           <tr>",
                        "               <th scope='row'>Skriving:</th>",
                        "               <td>",
                                            SkrivingText,
                        "               </td>",
                        "               <td>",
                                            SkrivingInput,
                        "                   <br>",
                                            UtleverteInput,
                        "               </td>",
                        "           </tr>",
                        "           <tr style='background-color: white;'>",
                        "               <th scope='row'>Manglende:</th>",
                        "               <td colspan='2'>",
                                            ManglendeInput,
                        "               </td>",
                        "           </tr>",
                        "           <tr>",
                        "               <th scope='row'>Diverse:</th>",
                        "               <td colspan='2'>",
                                            DivText,
                        "               </td>",
                        "           </tr>",
                        "           <tr style='background-color: white;'>",
                        "               <th scope='row'>Sjekkliste:</th>",
                        "               <td colspan='2'>",
                                            CheckInput,
                        "               </td>",
                        "           </tr>",
                        "       </tbody>",
                        "       <tfoot>",
                        "           <th scope='row'>Sendt by:</th>",
                        "           <td colspan='2'>",
                                        ThisUser,
                        "           </td>",
                        "       </tfoot>",
                        "   </table>",
                        "</body>",
                        "</html>"
                    )
                );
                Patch(
                    Table1,
                    Defaults(Table1),
                    {
                        Avkast: AvkastText,
                        Skriving: SkrivingText,
                        'Diverse - HA': DivText,
                        'Numbers Avkast': NumInput,
                        Checklist: CheckInput,
                        Name: ThisUser,
                        Timestamp: Text(
                            Now(),
                            ShortDateTime24
                        ),
                        Group: Left(
                            Office365Users.MyProfile().Department,
                            6
                        ),
                        Topic: Header,
                        Shift: ShiftCheck
                    }
                );
                Office365Outlook.SendEmailV2(
                    "zulifqar.haider@posten.no;
                    Thomas.Nystuen@posten.no;
                    Jetmir.Ismaili@posten.no;
                    quynh.duong@posten.no;
                    ole.johansen@posten.no;
                    olejorgen.moen@posten.no;
                    janne.muan@posten.no",
                    Header,
                    Body,
                    {
                        Importance: Normal,
                        IsHtml: true,
                        ReplyTo: "haider.zulifqar@posten.no",
                        Cc: "robin.lysaker@posten.no"
                    }
                );
                Navigate(
                    SucessScreen,
                    ScreenTransition.CoverRight
                )
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =32
            Text: ="JA"
            Visible: =vPopUp
            Width: =250
            X: =43
            Y: =711
            ZIndex: =6

        Button1_4 As button:
            BorderThickness: =0
            Color: =RGBA(123, 193, 68, 1)
            Fill: =RGBA(0, 47, 25, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, 75%)
            FontWeight: =Bold
            Height: =70
            HoverFill: =ColorFade(RGBA(0,100,58,1), -20%)
            OnSelect: |-
                =UpdateContext({vPopUp: false})
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =32
            Text: ="NEI"
            Visible: =vPopUp
            Width: =250
            X: =353
            Y: =711
            ZIndex: =7

