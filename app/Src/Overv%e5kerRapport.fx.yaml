OvervåkerRapport As screen:
    Fill: =RGBA(255, 255, 255, 1)

    Image1 As image:
        DisplayMode: =DisplayMode.View
        Height: =1136
        Image: ='Anders+Nord_Post+Norway_Brand+Identity_17'
        ImagePosition: =ImagePosition.Fill
        Transparency: =0.8
        Width: =640
        ZIndex: =1

    HtmlText1_5 As htmlViewer:
        Height: =154
        HtmlText: |-
            ="<div 
                style='
                    margin:10px;
                    width:560px;
                    height: 70px;
                    background-color:#;
                    box-shadow:0px 0px 20px -2px #ACB2B3;'>
                    </div>"
        Width: =612
        X: =25
        Y: =1020
        ZIndex: =2

    HtmlText1_1 As htmlViewer:
        Height: =154
        HtmlText: |-
            ="<div 
                style='
                    margin:10px;
                    width:560px;
                    height:70px;
                    background-color:#;
                    box-shadow:0px 0px 20px -2px #ACB2B3;'>
                    </div>"
        Width: =612
        X: =25
        Y: =336
        ZIndex: =3

    HtmlText1_2 As htmlViewer:
        Height: =154
        HtmlText: |-
            ="<div 
                style='
                    margin:10px;
                    width:560px;
                    height:70px;
                    background-color:#;
                    box-shadow:0px 0px 20px -2px #ACB2B3;'>
                    </div>"
        Width: =612
        X: =25
        Y: =477
        ZIndex: =4

    HtmlText1_3 As htmlViewer:
        Height: =154
        HtmlText: |-
            ="<div 
                style='
                    margin:10px;
                    width:560px;
                    height:70px;
                    background-color:#;
                    box-shadow:0px 0px 20px -2px #ACB2B3;'>
                    </div>"
        Width: =612
        X: =25
        Y: =620
        ZIndex: =5

    HtmlText1_4 As htmlViewer:
        Height: =154
        HtmlText: |-
            ="<div 
                style='
                    margin:10px;
                    width:560px;
                    height: 70px;
                    background-color:#;
                    box-shadow:0px 0px 20px -2px #ACB2B3;'>
                    </div>"
        Width: =612
        X: =28
        Y: =774
        ZIndex: =6

    HtmlText1 As htmlViewer:
        Height: =169
        HtmlText: |-
            ="<div 
                style='
                    margin:10px;
                    width:560px;
                    height:70px;
                    background-color:#;
                    box-shadow:0px 0px 20px -2px #ACB2B3;'>
                    </div>"
        Width: =612
        X: =25
        Y: =180
        ZIndex: =7

    Button1 As button:
        BorderThickness: =0
        Color: =RGBA(123, 193, 68, 1)
        Fill: =RGBA(0, 47, 25, 1)
        FocusedBorderColor: =ColorFade(Self.Fill, 75%)
        FontWeight: =Bold
        Height: =70
        HoverFill: =ColorFade(RGBA(0,100,58,1), -20%)
        OnSelect: |-
            =UpdateContext({vPopUp: true})
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =32
        Text: ="SEND MAIL"
        Width: =560
        X: =40
        Y: =1036
        ZIndex: =8

    FlytText As text:
        BorderThickness: =0
        Clear: =true
        Default: =""
        Height: =70
        Mode: =TextMode.MultiLine
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =21
        Width: =560
        X: =40
        Y: =195
        ZIndex: =9

    Label1 As label:
        Align: =Align.Center
        FontWeight: =Bold
        Height: =62
        Size: =21
        Text: ="Overvåker overlevering"
        Width: =560
        X: =40
        Y: =35
        ZIndex: =10

    FlytLabel As label:
        FontWeight: =Semibold
        Height: =70
        Size: =21
        Text: ="Generell Flyt"
        Width: =560
        X: =40
        Y: =125
        ZIndex: =11

    UtfordringerLabel As label:
        FontWeight: =Semibold
        Height: =70
        Size: =21
        Text: ="Utfordringer"
        Width: =560
        X: =40
        Y: =279
        ZIndex: =12

    UtfordringerText As text:
        BorderThickness: =0
        Default: =""
        Height: |
            =70
        Mode: =TextMode.MultiLine
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =21
        Width: =560
        X: =40
        Y: =349
        ZIndex: =13

    B2Label As label:
        FontWeight: =Semibold
        Height: =70
        Size: =21
        Text: ="B2"
        Width: =560
        X: =40
        Y: =428
        ZIndex: =14

    B2Text As text:
        BorderThickness: =0
        Default: =""
        Height: =70
        Mode: =TextMode.MultiLine
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =21
        Width: =560
        X: =40
        Y: =490
        ZIndex: =15

    DiverseLabel As label:
        FontWeight: =Semibold
        Height: =70
        Size: =21
        Text: ="Diverse"
        Width: =560
        X: =40
        Y: =722
        ZIndex: =16

    DiverseText As text:
        BorderThickness: =0
        Default: =""
        Height: =70
        Mode: =TextMode.MultiLine
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =21
        Width: =560
        X: =40
        Y: =787
        ZIndex: =17

    B3Label As label:
        FontWeight: =Semibold
        Height: =70
        Size: =21
        Text: ="B3"
        Width: =560
        X: =40
        Y: =572
        ZIndex: =18

    B3Text As text:
        BorderThickness: =0
        Default: =""
        Height: =70
        Mode: =TextMode.MultiLine
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =21
        Width: =560
        X: =40
        Y: =635
        ZIndex: =19

    Label2 As label:
        Align: =Align.Right
        Height: =Label1.Height
        Size: =21
        Text: =Text(Now(),ShortTime24)
        Visible: =false
        Width: =121
        X: =479
        Y: =35
        ZIndex: =20

    OvervåkerBackBtn As icon.BackArrow:
        Color: =RGBA(0, 0, 0, 1)
        Icon: =Icon.BackArrow
        OnSelect: =Back(ScreenTransition.UnCoverRight)
        X: =536
        Y: =33
        ZIndex: =23

    Group1 As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =27

        OvervåkerBackdropAndHTML As htmlViewer:
            Height: =1136
            HtmlText: |-
                ="<div style='
                    background-color:rgba(255,255,255,0.8);
                    height: 1125px;
                    display: grid;
                    place-content: center;
                '>
                <p style='margin: auto auto 0 auto'>Sende e-post?</p>
                <p style='margin: 0 auto 0 auto'>Send mail?</p>
                </div>"
            Visible: =vPopUp
            Width: =637
            ZIndex: =24

        OvervåkerSendMailBtn As button:
            BorderThickness: =0
            Color: =RGBA(123, 193, 68, 1)
            Fill: =RGBA(0, 47, 25, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, 75%)
            FontWeight: =Bold
            Height: =70
            HoverFill: =ColorFade(RGBA(0,100,58,1), -20%)
            OnSelect: |-
                =Set(
                    Recipients,
                    "jihad.eldor@posten.no; nighat.ali@posten.no; thomas.svaeren@bring.com; Ahmet.Incesoy@posten.no; zulifqar.haider@posten.no;terje.aas@posten.no; christopher.andersen@posten.no; Wisam.Abuafifeh@posten.no; kristine.myrhagen@posten.no; tom.inge.kvaernstuen@posten.no; maawya.hussein@posten.no; glenn.hegstad@posten.no; elin.oldemark@posten.no; gard.nordsveen@posten.no; heidi.aldal@posten.no;Logistikk.Norge.ROAO.LSO.Oslo.Overvakere@posten.no"
                );
                Set(
                    TestRecip,
                    "robin.lysaker@posten.no"
                );
                Set(
                    HeaderRapport,
                    Label1.Text
                );
                //Setting some variables
                Set(
                    FlytHeader,
                    FlytLabel.Text
                );
                Set(
                    FlytBody,
                    FlytText.Text
                );
                Set(
                    UtfordringsHeader,
                    UtfordringerLabel.Text
                );
                Set(
                    UtfordringBody,
                    UtfordringerText.Text
                );
                Set(
                    B2Header,
                    B2Label.Text
                );
                Set(
                    B2Body,
                    B2Text.Text
                );
                Set(
                    B3Header,
                    B3Label.Text
                );
                Set(
                    B3Body,
                    B3Text.Text
                );
                Set(
                    DivHeader,
                    DiverseLabel.Text
                );
                Set(
                    DivBody,
                    DiverseText.Text
                );
                Set(
                    Body,
                    Concatenate(
                        "<!DOCTYPE html>",
                        "<html lang='en'>",
                        "<head>",
                        "<meta charset='UTF-8'>",
                        "<meta http-equiv='X-UA-Compatible' content='IE=edge'>",
                        "<meta name='viewport' content='width=device-width, initial-scale=1.0'>",
                        "<title>RAPPORT</title>",
                        "<style>",
                        "   body {background-color: #f1f7e9;} ",
                        "   table {",
                        "       table-layout: fixed;",
                        "       width: 100%;",
                        "       height: 100%;",
                        "       font-family: Verdana, Geneva, Tahoma, sans-serif;",
                        "       border-collapse: collapse;}",
                        "       caption {padding: 10px; font-weight: bolder; font-size: 20px;}",
                        "       thead {height: 50px;}",
                        "       tr {border-bottom: 2px solid rgb(237, 157, 157);}",
                        "       th, td {text-align: start; width: 30%;}",
                        "       th {padding: 10px;}",
                        "</style>",
                        "</head>",
                        "<body>",
                        "   <table>",
                        "       <caption>",
                        HeaderRapport,
                        "       </caption>",
                        "       <thead>",
                        "           <tr>",
                        "               <th scope='col'></th>",
                        "               <th style='text-align: start' scope='col'></th>",
                        "               <th style='text-align: start' scope='col'></th>",
                        "           </tr>",
                        "       </thead>",
                        "       <tbody>",
                        "           <tr style='background-color: white;'>",
                        "               <th scope='row'>Generell Flyt:</th>",
                        "               <td colspan='2'>",
                        FlytBody,
                        "               </td>",
                        "           </tr>",
                        "           <tr>",
                        "               <th scope='row'>Utfordringer:</th>",
                        "               <td colspan='2'>",
                        UtfordringBody,
                        "               </td>",
                        "           </tr>",
                        "           <tr style='background-color: white;'>",
                        "               <th scope='row'>B2:</th>",
                        "               <td colspan='2'>",
                        B2Body,
                        "               </td>",
                        "           </tr>",
                        "           <tr>",
                        "               <th scope='row'>B3:</th>",
                        "               <td colspan='2'>",
                        B3Body,
                        "               </td>",
                        "           </tr>",
                        "           <tr style='background-color: white;'>",
                        "               <th scope='row'>Diverse:</th>",
                        "               <td colspan='2'>",
                        DivBody,
                        "               </td>",
                        "           </tr>",
                        "       </tbody>",
                        "       <tfoot>",
                        "           <th scope='row'>Sendt by:</th>",
                        "           <td colspan='2'>",
                        ThisUser,
                        "           </td>",
                        "       </tfoot>",
                        "   </table>",
                        "</body>",
                        "</html>"
                    )
                );
                Patch(
                    Table1,
                    Defaults(Table1),
                    {
                        'Generell Flyt': FlytText.Text,
                        Utfordringer: UtfordringerText.Text,
                        'Diverse - OV': DiverseText.Text,
                        B2: B2Text.Text,
                        B3: B3Text.Text,
                        Name: Office365Users.MyProfile().DisplayName,
                        Timestamp: Text(
                            Now(),
                            ShortDateTime24
                        ),
                        Group: Left(
                            Office365Users.MyProfile().Department,
                            6
                        ),
                        Topic: "Overvåker Overlevering",
                        Shift: If(
                            Int(
                                Left(
                                    Label2,
                                    2
                                )
                            ) <= 7,
                            "Early Shift",
                            Int(
                                Left(
                                    Label2,
                                    2
                                )
                            ) >= 20,
                            "Evening Shift",
                            "Day Shift"
                        )
                    }
                );
                Office365Outlook.SendEmailV2(
                    Recipients,
                    HeaderRapport,
                    Body,
                    {
                        Importance: Normal,
                        IsHtml: true,
                        ReplyTo: "Logistikk.Norge.ROAO.LSO.Oslo.Overvakere@posten.no",
                        Cc: "robin.lysaker@posten.no",
                        Attachments: AddColumns(
                            RenameColumns(
                                OvervåkerAttachment.Attachments,
                                "Value",
                                "ContentBytes"
                            ),
                            "@odata.type",
                            ""
                        )
                    }
                );
                Navigate(
                    SucessScreen,
                    ScreenTransition.CoverRight
                )
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =32
            Text: ="JA"
            Visible: =vPopUp
            Width: =250
            X: =40
            Y: =711
            ZIndex: =25

        OvervåkerCancelBtn As button:
            BorderThickness: =0
            Color: =RGBA(123, 193, 68, 1)
            Fill: =RGBA(0, 47, 25, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, 75%)
            FontWeight: =Bold
            Height: =70
            HoverFill: =ColorFade(RGBA(0,100,58,1), -20%)
            OnSelect: |-
                =UpdateContext({vPopUp: false})
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =32
            Text: ="NEI"
            Visible: =vPopUp
            Width: =250
            X: =350
            Y: =711
            ZIndex: =26

    OvervåkerAttachment As attachments:
        BorderColor: =BlueViolet
        Height: =126
        IsInDataCard: =true
        Items: =
        PaddingBottom: =5
        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
        PaddingRight: =5
        PaddingTop: =5
        Size: =16
        Tooltip: ="Add Files here"
        Width: =556
        X: =44
        Y: =888
        ZIndex: =29

